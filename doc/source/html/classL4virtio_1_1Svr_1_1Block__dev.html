<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>L4Re - L4 Runtime Environment: L4virtio::Svr::Block_dev&lt; Ds_data &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="l4re.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">L4Re - L4 Runtime Environment
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classL4virtio_1_1Svr_1_1Block__dev.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">L4virtio::Svr::Block_dev&lt; Ds_data &gt; Class Template Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>Base class for virtio block devices.  
 <a href="classL4virtio_1_1Svr_1_1Block__dev.html#details">More...</a></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for L4virtio::Svr::Block_dev&lt; Ds_data &gt;:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classL4virtio_1_1Svr_1_1Block__dev__inherit__graph.png" border="0" usemap="#L4virtio_1_1Svr_1_1Block__dev_3_01Ds__data_01_4_inherit__map" alt="Inheritance graph"/></div>
<map name="L4virtio_1_1Svr_1_1Block__dev_3_01Ds__data_01_4_inherit__map" id="L4virtio_1_1Svr_1_1Block__dev_3_01Ds__data_01_4_inherit__map">
<area shape="rect" id="node2" href="classL4virtio_1_1Svr_1_1Device__t.html" title="{L4virtio::Svr::Device\l_t\&lt; Ds_data \&gt;\n|# _mem_info\l|+ L4_RPC_LEGACY_DISPATCH()\l+ virtio_dispatch()\l+ reset()\l+ check_features()\l+ check_queues()\l+ reconfig_queue()\l+ register_single_driver_irq()\l+ device_notify_irq()\l+ device_notify_irq()\l+ register_driver_irq()\land 23 more...\l}" alt="" coords="5,307,245,545"/>
<area shape="rect" id="node3" href="classL4virtio_1_1Svr_1_1Device__t.html" title="Server&#45;side L4&#45;VIRTIO device stub. " alt="" coords="5,5,245,244"/>
</map>
</div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Collaboration diagram for L4virtio::Svr::Block_dev&lt; Ds_data &gt;:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classL4virtio_1_1Svr_1_1Block__dev__coll__graph.png" border="0" usemap="#L4virtio_1_1Svr_1_1Block__dev_3_01Ds__data_01_4_coll__map" alt="Collaboration graph"/></div>
<map name="L4virtio_1_1Svr_1_1Block__dev_3_01Ds__data_01_4_coll__map" id="L4virtio_1_1Svr_1_1Block__dev_3_01Ds__data_01_4_coll__map">
<area shape="rect" id="node2" href="classL4virtio_1_1Svr_1_1Device__t.html" title="{L4virtio::Svr::Device\l_t\&lt; Ds_data \&gt;\n||+ L4_RPC_LEGACY_DISPATCH()\l+ virtio_dispatch()\l+ reset()\l+ check_features()\l+ check_queues()\l+ reconfig_queue()\l+ register_single_driver_irq()\l+ device_notify_irq()\l+ device_notify_irq()\l+ register_driver_irq()\land 23 more...\l}" alt="" coords="146,579,386,817"/>
<area shape="rect" id="node3" href="classL4virtio_1_1Svr_1_1Driver__mem__list__t.html" title="{L4virtio::Svr::Driver\l_mem_list_t\&lt; Ds_data \&gt;\n||+ Driver_mem_list_t()\l+ init()\l+ full()\l+ add()\l+ remove()\l+ find()\l+ load_desc()\l+ load_desc()\l+ load_desc()\l}" alt="" coords="5,292,180,501"/>
<area shape="rect" id="node4" href="classL4virtio_1_1Svr_1_1Driver__mem__list__t.html" title="List of driver memory regions assigned to a single L4&#45;VIRTIO transport instance. " alt="" coords="13,5,172,215"/>
<area shape="rect" id="node5" href="classL4virtio_1_1Svr_1_1Device__t.html" title="Server&#45;side L4&#45;VIRTIO device stub. " alt="" coords="205,277,445,516"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8a85a479c23771b521483b4bd07fcf05"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html#a8a85a479c23771b521483b4bd07fcf05">Block_dev</a> (<a class="el" href="group__l4__basic__types.html#gac1d09f3e382e711b776931f10e6e1e5a">l4_uint32_t</a> vendor, unsigned queue_size, <a class="el" href="group__l4__basic__types.html#gaf3331c485014bd12a9e4f9d27a55e689">l4_uint64_t</a> capacity, bool read_only)</td></tr>
<tr class="memdesc:a8a85a479c23771b521483b4bd07fcf05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new virtio block device.  <a href="#a8a85a479c23771b521483b4bd07fcf05">More...</a><br /></td></tr>
<tr class="separator:a8a85a479c23771b521483b4bd07fcf05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a23e93049f4a3d3bdc90103b4c5ea0e"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html#a8a23e93049f4a3d3bdc90103b4c5ea0e">process_request</a> (cxx::unique_ptr&lt; <a class="el" href="classL4virtio_1_1Svr_1_1Block__request.html">Request</a> &gt; &amp;&amp;req)=0</td></tr>
<tr class="memdesc:a8a23e93049f4a3d3bdc90103b4c5ea0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implements the actual processing of data in the device.  <a href="#a8a23e93049f4a3d3bdc90103b4c5ea0e">More...</a><br /></td></tr>
<tr class="separator:a8a23e93049f4a3d3bdc90103b4c5ea0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4922b1284948425891aabb754757d6dd"><td class="memItemLeft" align="right" valign="top"><a id="a4922b1284948425891aabb754757d6dd"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html#a4922b1284948425891aabb754757d6dd">reset_device</a> ()=0</td></tr>
<tr class="memdesc:a4922b1284948425891aabb754757d6dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the actual hardware device. <br /></td></tr>
<tr class="separator:a4922b1284948425891aabb754757d6dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a684fb0f113476b80e6d393c807ff18f5"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html#a684fb0f113476b80e6d393c807ff18f5">reset_client</a> ()</td></tr>
<tr class="memdesc:a684fb0f113476b80e6d393c807ff18f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">The client requests reinitialisation of the connection.  <a href="#a684fb0f113476b80e6d393c807ff18f5">More...</a><br /></td></tr>
<tr class="separator:a684fb0f113476b80e6d393c807ff18f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a2eb85cab33f0e06f3af85b5aadcf88"><td class="memItemLeft" align="right" valign="top"><a id="a0a2eb85cab33f0e06f3af85b5aadcf88"></a>
virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html#a0a2eb85cab33f0e06f3af85b5aadcf88">queue_stopped</a> ()=0</td></tr>
<tr class="memdesc:a0a2eb85cab33f0e06f3af85b5aadcf88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return true, if the queues should not be processed further. <br /></td></tr>
<tr class="separator:a0a2eb85cab33f0e06f3af85b5aadcf88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac61e624498b347a460982c377d071a6f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html#ac61e624498b347a460982c377d071a6f">finalize_request</a> (cxx::unique_ptr&lt; <a class="el" href="classL4virtio_1_1Svr_1_1Block__request.html">Request</a> &gt; req, unsigned sz, <a class="el" href="group__l4__basic__types.html#ga9678dc2e6bf3e4d8ec950162576b0fad">l4_uint8_t</a> status=<a class="el" href="group__l4virtio__block.html#ggafefb8205febb8b89e612e86f0c89eaa9a52c6169e59039d478b7f4a9faec15f33">L4VIRTIO_BLOCK_S_OK</a>)</td></tr>
<tr class="memdesc:ac61e624498b347a460982c377d071a6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Releases resources related to a request and notifies the client.  <a href="#ac61e624498b347a460982c377d071a6f">More...</a><br /></td></tr>
<tr class="separator:ac61e624498b347a460982c377d071a6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a24d0f2f570b4c08a44d53e32ee7763"><td class="memItemLeft" align="right" valign="top"><a id="a1a24d0f2f570b4c08a44d53e32ee7763"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html#a1a24d0f2f570b4c08a44d53e32ee7763">reconfig_queue</a> (unsigned idx)</td></tr>
<tr class="memdesc:a1a24d0f2f570b4c08a44d53e32ee7763"><td class="mdescLeft">&#160;</td><td class="mdescRight">callback for client queue-config request <br /></td></tr>
<tr class="separator:a1a24d0f2f570b4c08a44d53e32ee7763"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a96e928470518780132b45397e8ad35"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classL4_1_1Cap.html">L4::Cap</a>&lt; void &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html#a9a96e928470518780132b45397e8ad35">register_obj</a> (<a class="el" href="classL4_1_1Registry__iface.html">L4::Registry_iface</a> *registry, char const *service=0)</td></tr>
<tr class="memdesc:a9a96e928470518780132b45397e8ad35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attach device to an object registry.  <a href="#a9a96e928470518780132b45397e8ad35">More...</a><br /></td></tr>
<tr class="separator:a9a96e928470518780132b45397e8ad35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classL4virtio_1_1Svr_1_1Device__t')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classL4virtio_1_1Svr_1_1Device__t.html">L4virtio::Svr::Device_t&lt; Ds_data &gt;</a></td></tr>
<tr class="memitem:a858188800d304a06069db6c04020fc47 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="memItemLeft" align="right" valign="top"><a id="a858188800d304a06069db6c04020fc47"></a>
virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Device__t.html#a858188800d304a06069db6c04020fc47">check_features</a> ()</td></tr>
<tr class="memdesc:a858188800d304a06069db6c04020fc47 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">callback for checking the subset of accepted features <br /></td></tr>
<tr class="separator:a858188800d304a06069db6c04020fc47 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f19c5c3627951e871dcd868aec32aa1 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classL4_1_1Cap.html">L4::Cap</a>&lt; <a class="el" href="classL4_1_1Irq.html">L4::Irq</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Device__t.html#a6f19c5c3627951e871dcd868aec32aa1">device_notify_irq</a> (unsigned idx)</td></tr>
<tr class="memdesc:a6f19c5c3627951e871dcd868aec32aa1 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback to gather the device notification IRQ (multi IRQ).  <a href="classL4virtio_1_1Svr_1_1Device__t.html#a6f19c5c3627951e871dcd868aec32aa1">More...</a><br /></td></tr>
<tr class="separator:a6f19c5c3627951e871dcd868aec32aa1 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66d09e200e34ccad61e5843d2b5bb0a0 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Device__t.html#a66d09e200e34ccad61e5843d2b5bb0a0">register_driver_irq</a> (unsigned idx)</td></tr>
<tr class="memdesc:a66d09e200e34ccad61e5843d2b5bb0a0 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback for registering an notification IRQ (multi IRQ).  <a href="classL4virtio_1_1Svr_1_1Device__t.html#a66d09e200e34ccad61e5843d2b5bb0a0">More...</a><br /></td></tr>
<tr class="separator:a66d09e200e34ccad61e5843d2b5bb0a0 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9536bf0c6e00b566c78c6abe80a68780 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="memItemLeft" align="right" valign="top"><a id="a9536bf0c6e00b566c78c6abe80a68780"></a>
virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Device__t.html#a9536bf0c6e00b566c78c6abe80a68780">num_events_supported</a> () const</td></tr>
<tr class="memdesc:a9536bf0c6e00b566c78c6abe80a68780 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the highest notification index supported. <br /></td></tr>
<tr class="separator:a9536bf0c6e00b566c78c6abe80a68780 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ce755ee0579fb70926d762ba67bb66f inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="memItemLeft" align="right" valign="top"><a id="a7ce755ee0579fb70926d762ba67bb66f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Device__t.html#a7ce755ee0579fb70926d762ba67bb66f">Device_t</a> (<a class="el" href="classL4virtio_1_1Svr_1_1Dev__config.html">Dev_config</a> *dev_config)</td></tr>
<tr class="memdesc:a7ce755ee0579fb70926d762ba67bb66f inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make a device for the given config. <br /></td></tr>
<tr class="separator:a7ce755ee0579fb70926d762ba67bb66f inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fa20bf911056f0d03c8274982b1e167 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="memItemLeft" align="right" valign="top"><a id="a3fa20bf911056f0d03c8274982b1e167"></a>
<a class="el" href="classL4virtio_1_1Svr_1_1Driver__mem__list__t.html">Mem_list</a> const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Device__t.html#a3fa20bf911056f0d03c8274982b1e167">mem_info</a> () const</td></tr>
<tr class="memdesc:a3fa20bf911056f0d03c8274982b1e167 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the memory region list used for this device. <br /></td></tr>
<tr class="separator:a3fa20bf911056f0d03c8274982b1e167 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedbe988112e98750e5409a8c92358dcf inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Device__t.html#aedbe988112e98750e5409a8c92358dcf">reset_queue_config</a> (unsigned idx, unsigned num_max, bool inc_generation=false)</td></tr>
<tr class="memdesc:aedbe988112e98750e5409a8c92358dcf inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">Trigger reset for the configuration space for queue <em>idx</em>.  <a href="classL4virtio_1_1Svr_1_1Device__t.html#aedbe988112e98750e5409a8c92358dcf">More...</a><br /></td></tr>
<tr class="separator:aedbe988112e98750e5409a8c92358dcf inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac13ae09cfc41fad98bd25c2d76bfac63 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Device__t.html#ac13ae09cfc41fad98bd25c2d76bfac63">init_mem_info</a> (unsigned num)</td></tr>
<tr class="memdesc:ac13ae09cfc41fad98bd25c2d76bfac63 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the memory region list to the given maximum.  <a href="classL4virtio_1_1Svr_1_1Device__t.html#ac13ae09cfc41fad98bd25c2d76bfac63">More...</a><br /></td></tr>
<tr class="separator:ac13ae09cfc41fad98bd25c2d76bfac63 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29f780ecb04509d8b72f4a155b073c74 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Device__t.html#a29f780ecb04509d8b72f4a155b073c74">device_error</a> ()</td></tr>
<tr class="memdesc:a29f780ecb04509d8b72f4a155b073c74 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transition device into failed state.  <a href="classL4virtio_1_1Svr_1_1Device__t.html#a29f780ecb04509d8b72f4a155b073c74">More...</a><br /></td></tr>
<tr class="separator:a29f780ecb04509d8b72f4a155b073c74 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab906b4cc61026fd815a8056f07bef10e inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Device__t.html#ab906b4cc61026fd815a8056f07bef10e">setup_queue</a> (<a class="el" href="classL4virtio_1_1Svr_1_1Virtqueue.html">Virtqueue</a> *q, unsigned qn, unsigned num_max)</td></tr>
<tr class="memdesc:ab906b4cc61026fd815a8056f07bef10e inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable/disable the specified queue.  <a href="classL4virtio_1_1Svr_1_1Device__t.html#ab906b4cc61026fd815a8056f07bef10e">More...</a><br /></td></tr>
<tr class="separator:ab906b4cc61026fd815a8056f07bef10e inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a460f5dc2b32e33a616eb822ffd2f88f0 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Device__t.html#a460f5dc2b32e33a616eb822ffd2f88f0">handle_mem_cmd_write</a> ()</td></tr>
<tr class="memdesc:a460f5dc2b32e33a616eb822ffd2f88f0 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for a value in the <code>cmd</code> register and handle a write.  <a href="classL4virtio_1_1Svr_1_1Device__t.html#a460f5dc2b32e33a616eb822ffd2f88f0">More...</a><br /></td></tr>
<tr class="separator:a460f5dc2b32e33a616eb822ffd2f88f0 inherit pub_methods_classL4virtio_1_1Svr_1_1Device__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:abc38063578852cdd9b3c7ef343e370e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html#abc38063578852cdd9b3c7ef343e370e9">set_size_max</a> (<a class="el" href="group__l4__basic__types.html#gac1d09f3e382e711b776931f10e6e1e5a">l4_uint32_t</a> sz)</td></tr>
<tr class="memdesc:abc38063578852cdd9b3c7ef343e370e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the maximum size of any single segment reported to client.  <a href="#abc38063578852cdd9b3c7ef343e370e9">More...</a><br /></td></tr>
<tr class="separator:abc38063578852cdd9b3c7ef343e370e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbe4148c691d589fe12c63a7cb4a4557"><td class="memItemLeft" align="right" valign="top"><a id="acbe4148c691d589fe12c63a7cb4a4557"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html#acbe4148c691d589fe12c63a7cb4a4557">set_seg_max</a> (<a class="el" href="group__l4__basic__types.html#gac1d09f3e382e711b776931f10e6e1e5a">l4_uint32_t</a> sz)</td></tr>
<tr class="memdesc:acbe4148c691d589fe12c63a7cb4a4557"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the maximum number of segments in a request that is reported to client. <br /></td></tr>
<tr class="separator:acbe4148c691d589fe12c63a7cb4a4557"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74306b787bc9000a00ad0d1fc97be14a"><td class="memItemLeft" align="right" valign="top"><a id="a74306b787bc9000a00ad0d1fc97be14a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html#a74306b787bc9000a00ad0d1fc97be14a">set_geometry</a> (<a class="el" href="group__l4__basic__types.html#gae8d67914f723bf843df6f311ad2619a2">l4_uint16_t</a> cylinders, <a class="el" href="group__l4__basic__types.html#ga9678dc2e6bf3e4d8ec950162576b0fad">l4_uint8_t</a> heads, <a class="el" href="group__l4__basic__types.html#ga9678dc2e6bf3e4d8ec950162576b0fad">l4_uint8_t</a> sectors)</td></tr>
<tr class="memdesc:a74306b787bc9000a00ad0d1fc97be14a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set disk geometry that is reported to the client. <br /></td></tr>
<tr class="separator:a74306b787bc9000a00ad0d1fc97be14a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abeef159327c9e9b9ba2df195cc532c8f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html#abeef159327c9e9b9ba2df195cc532c8f">set_blk_size</a> (<a class="el" href="group__l4__basic__types.html#gac1d09f3e382e711b776931f10e6e1e5a">l4_uint32_t</a> sz)</td></tr>
<tr class="memdesc:abeef159327c9e9b9ba2df195cc532c8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets block disk size to be reported to the client.  <a href="#abeef159327c9e9b9ba2df195cc532c8f">More...</a><br /></td></tr>
<tr class="separator:abeef159327c9e9b9ba2df195cc532c8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ab6d54f2230cb5b5d65489e78c7bee7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html#a9ab6d54f2230cb5b5d65489e78c7bee7">set_topology</a> (<a class="el" href="group__l4__basic__types.html#ga9678dc2e6bf3e4d8ec950162576b0fad">l4_uint8_t</a> physical_block_exp, <a class="el" href="group__l4__basic__types.html#ga9678dc2e6bf3e4d8ec950162576b0fad">l4_uint8_t</a> alignment_offset, <a class="el" href="group__l4__basic__types.html#gac1d09f3e382e711b776931f10e6e1e5a">l4_uint32_t</a> min_io_size, <a class="el" href="group__l4__basic__types.html#gac1d09f3e382e711b776931f10e6e1e5a">l4_uint32_t</a> opt_io_size)</td></tr>
<tr class="memdesc:a9ab6d54f2230cb5b5d65489e78c7bee7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the I/O alignment information reported back to the client.  <a href="#a9ab6d54f2230cb5b5d65489e78c7bee7">More...</a><br /></td></tr>
<tr class="separator:a9ab6d54f2230cb5b5d65489e78c7bee7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52e16868ed3be9c9dd2f1e1012f7a74e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html#a52e16868ed3be9c9dd2f1e1012f7a74e">set_flush</a> ()</td></tr>
<tr class="memdesc:a52e16868ed3be9c9dd2f1e1012f7a74e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables the flush command.  <a href="#a52e16868ed3be9c9dd2f1e1012f7a74e">More...</a><br /></td></tr>
<tr class="separator:a52e16868ed3be9c9dd2f1e1012f7a74e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a350f618127159859e8f361b2d76dacbc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html#a350f618127159859e8f361b2d76dacbc">set_config_wce</a> (<a class="el" href="group__l4__basic__types.html#ga9678dc2e6bf3e4d8ec950162576b0fad">l4_uint8_t</a> writeback)</td></tr>
<tr class="memdesc:a350f618127159859e8f361b2d76dacbc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets cache mode and enables the the writeback toggle.  <a href="#a350f618127159859e8f361b2d76dacbc">More...</a><br /></td></tr>
<tr class="separator:a350f618127159859e8f361b2d76dacbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d01aee492008958deb0ad7b2fa1b25c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__l4__basic__types.html#ga9678dc2e6bf3e4d8ec950162576b0fad">l4_uint8_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html#a9d01aee492008958deb0ad7b2fa1b25c">get_writeback</a> ()</td></tr>
<tr class="memdesc:a9d01aee492008958deb0ad7b2fa1b25c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the writeback field from the configuration space.  <a href="#a9d01aee492008958deb0ad7b2fa1b25c">More...</a><br /></td></tr>
<tr class="separator:a9d01aee492008958deb0ad7b2fa1b25c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85cb8c12aeca3b4538a1bb6c617b2a8b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html#a85cb8c12aeca3b4538a1bb6c617b2a8b">set_discard</a> (<a class="el" href="group__l4__basic__types.html#gac1d09f3e382e711b776931f10e6e1e5a">l4_uint32_t</a> max_discard_sectors, <a class="el" href="group__l4__basic__types.html#gac1d09f3e382e711b776931f10e6e1e5a">l4_uint32_t</a> max_discard_seg, <a class="el" href="group__l4__basic__types.html#gac1d09f3e382e711b776931f10e6e1e5a">l4_uint32_t</a> discard_sector_alignment)</td></tr>
<tr class="memdesc:a85cb8c12aeca3b4538a1bb6c617b2a8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets constraints for and enables the discard command.  <a href="#a85cb8c12aeca3b4538a1bb6c617b2a8b">More...</a><br /></td></tr>
<tr class="separator:a85cb8c12aeca3b4538a1bb6c617b2a8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3761d8e4378958f269298ae4d3fc0cbb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html#a3761d8e4378958f269298ae4d3fc0cbb">set_write_zeroes</a> (<a class="el" href="group__l4__basic__types.html#gac1d09f3e382e711b776931f10e6e1e5a">l4_uint32_t</a> max_write_zeroes_sectors, <a class="el" href="group__l4__basic__types.html#gac1d09f3e382e711b776931f10e6e1e5a">l4_uint32_t</a> max_write_zeroes_seg, <a class="el" href="group__l4__basic__types.html#ga9678dc2e6bf3e4d8ec950162576b0fad">l4_uint8_t</a> write_zeroes_may_unmap)</td></tr>
<tr class="memdesc:a3761d8e4378958f269298ae4d3fc0cbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets constraints for and enables the write zeroes command.  <a href="#a3761d8e4378958f269298ae4d3fc0cbb">More...</a><br /></td></tr>
<tr class="separator:a3761d8e4378958f269298ae4d3fc0cbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classL4virtio_1_1Svr_1_1Device__t"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classL4virtio_1_1Svr_1_1Device__t')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classL4virtio_1_1Svr_1_1Device__t.html">L4virtio::Svr::Device_t&lt; Ds_data &gt;</a></td></tr>
<tr class="memitem:a4ff8b5e4425d1b720b9751fbe501f68d inherit pro_attribs_classL4virtio_1_1Svr_1_1Device__t"><td class="memItemLeft" align="right" valign="top"><a id="a4ff8b5e4425d1b720b9751fbe501f68d"></a>
<a class="el" href="classL4virtio_1_1Svr_1_1Driver__mem__list__t.html">Mem_list</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classL4virtio_1_1Svr_1_1Device__t.html#a4ff8b5e4425d1b720b9751fbe501f68d">_mem_info</a></td></tr>
<tr class="memdesc:a4ff8b5e4425d1b720b9751fbe501f68d inherit pro_attribs_classL4virtio_1_1Svr_1_1Device__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">Memory region list. <br /></td></tr>
<tr class="separator:a4ff8b5e4425d1b720b9751fbe501f68d inherit pro_attribs_classL4virtio_1_1Svr_1_1Device__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename Ds_data&gt;<br />
class L4virtio::Svr::Block_dev&lt; Ds_data &gt;</h3>

<p>Base class for virtio block devices. </p>
<p>Use this class as a base to implement your own specific block device. </p>

<p class="definition">Definition at line <a class="el" href="virtio-block_source.html#l00023">23</a> of file <a class="el" href="virtio-block_source.html">virtio-block</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a8a85a479c23771b521483b4bd07fcf05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a85a479c23771b521483b4bd07fcf05">&#9670;&nbsp;</a></span>Block_dev()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Ds_data&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html">L4virtio::Svr::Block_dev</a>&lt; Ds_data &gt;::<a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html">Block_dev</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__l4__basic__types.html#gac1d09f3e382e711b776931f10e6e1e5a">l4_uint32_t</a>&#160;</td>
          <td class="paramname"><em>vendor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>queue_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__l4__basic__types.html#gaf3331c485014bd12a9e4f9d27a55e689">l4_uint64_t</a>&#160;</td>
          <td class="paramname"><em>capacity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>read_only</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a new virtio block device. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vendor</td><td>Vendor ID </td></tr>
    <tr><td class="paramname">queue_size</td><td>Number of entries to provide in avail and used queue. </td></tr>
    <tr><td class="paramname">capacity</td><td>Size of the device in 512-byte sectors. </td></tr>
    <tr><td class="paramname">read_only</td><td>True, if the device should not be writable. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="virtio-block_source.html#l00460">460</a> of file <a class="el" href="virtio-block_source.html">virtio-block</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ac61e624498b347a460982c377d071a6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac61e624498b347a460982c377d071a6f">&#9670;&nbsp;</a></span>finalize_request()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Ds_data&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html">L4virtio::Svr::Block_dev</a>&lt; Ds_data &gt;::finalize_request </td>
          <td>(</td>
          <td class="paramtype">cxx::unique_ptr&lt; <a class="el" href="classL4virtio_1_1Svr_1_1Block__request.html">Request</a> &gt;&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>sz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__l4__basic__types.html#ga9678dc2e6bf3e4d8ec950162576b0fad">l4_uint8_t</a>&#160;</td>
          <td class="paramname"><em>status</em> = <code><a class="el" href="group__l4virtio__block.html#ggafefb8205febb8b89e612e86f0c89eaa9a52c6169e59039d478b7f4a9faec15f33">L4VIRTIO_BLOCK_S_OK</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Releases resources related to a request and notifies the client. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">req</td><td>Pointer to request that has finished. </td></tr>
    <tr><td class="paramname">sz</td><td>Number of bytes consumed. </td></tr>
    <tr><td class="paramname">status</td><td>Status of request (see L4virtio_block_status).</td></tr>
  </table>
  </dd>
</dl>
<p>This function must be called when an asynchronous request finishes, either successfully or with an error. The status byte in the request must have been set prior to calling it. </p>

<p class="definition">Definition at line <a class="el" href="virtio-block_source.html#l00523">523</a> of file <a class="el" href="virtio-block_source.html">virtio-block</a>.</p>

</div>
</div>
<a id="a9d01aee492008958deb0ad7b2fa1b25c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d01aee492008958deb0ad7b2fa1b25c">&#9670;&nbsp;</a></span>get_writeback()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Ds_data&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__l4__basic__types.html#ga9678dc2e6bf3e4d8ec950162576b0fad">l4_uint8_t</a> <a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html">L4virtio::Svr::Block_dev</a>&lt; Ds_data &gt;::get_writeback </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the writeback field from the configuration space. </p>
<dl class="section return"><dt>Returns</dt><dd>Value of the writeback field. </dd></dl>

<p class="definition">Definition at line <a class="el" href="virtio-block_source.html#l00404">404</a> of file <a class="el" href="virtio-block_source.html">virtio-block</a>.</p>

</div>
</div>
<a id="a8a23e93049f4a3d3bdc90103b4c5ea0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a23e93049f4a3d3bdc90103b4c5ea0e">&#9670;&nbsp;</a></span>process_request()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Ds_data&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool <a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html">L4virtio::Svr::Block_dev</a>&lt; Ds_data &gt;::process_request </td>
          <td>(</td>
          <td class="paramtype">cxx::unique_ptr&lt; <a class="el" href="classL4virtio_1_1Svr_1_1Block__request.html">Request</a> &gt; &amp;&amp;&#160;</td>
          <td class="paramname"><em>req</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements the actual processing of data in the device. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">req</td><td>The request to be processed. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If false, no further requests will be scheduled.</dd></dl>
<p>Synchronous and asynchronous processing of the data is supported. For asynchronous mode, the function should set up the worker and then return false. In synchronous mode, the function should return true, once processing is complete. If there is an error and processing is aborted, the status flag of <code>req</code> needs to be set accordingly and the request immediately finished with finish_request() if the client is to be answered. </p>

</div>
</div>
<a id="a9a96e928470518780132b45397e8ad35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a96e928470518780132b45397e8ad35">&#9670;&nbsp;</a></span>register_obj()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Ds_data&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classL4_1_1Cap.html">L4::Cap</a>&lt;void&gt; <a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html">L4virtio::Svr::Block_dev</a>&lt; Ds_data &gt;::register_obj </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classL4_1_1Registry__iface.html">L4::Registry_iface</a> *&#160;</td>
          <td class="paramname"><em>registry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char const *&#160;</td>
          <td class="paramname"><em>service</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Attach device to an object registry. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">registry</td><td>Object registry that will be responsible for dispatching requests. </td></tr>
    <tr><td class="paramname">service</td><td>Name of an existing capability the device should use.</td></tr>
  </table>
  </dd>
</dl>
<p>This functions registers the general virtio interface as well as the interrupt handler which is used for receiving client notifications. </p>

<p class="definition">Definition at line <a class="el" href="virtio-block_source.html#l00557">557</a> of file <a class="el" href="virtio-block_source.html">virtio-block</a>.</p>

<p class="reference">References <a class="el" href="capability_8h_source.html#l00379">L4::cap_cast()</a>, <a class="el" href="error__helper_source.html#l00140">L4Re::chkcap()</a>, <a class="el" href="error__helper_source.html#l00063">L4Re::chksys()</a>, <a class="el" href="virtqueue_source.html#l00228">L4virtio::Virtqueue::disable()</a>, <a class="el" href="err_8h_source.html#l00056">L4_EINVAL</a>, <a class="el" href="virtio_source.html#l00144">L4virtio::Svr::Virtqueue::next_avail()</a>, <a class="el" href="virtqueue_source.html#l00403">L4virtio::Virtqueue::ready()</a>, <a class="el" href="classL4_1_1Registry__iface.html#ab2b05d116e522ebe06ebabe32bd7283a">L4::Registry_iface::register_irq_obj()</a>, and <a class="el" href="classL4_1_1Registry__iface.html#a5467da542075321062daab1bda1768bb">L4::Registry_iface::register_obj()</a>.</p>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classL4virtio_1_1Svr_1_1Block__dev_a9a96e928470518780132b45397e8ad35_cgraph.png" border="0" usemap="#classL4virtio_1_1Svr_1_1Block__dev_a9a96e928470518780132b45397e8ad35_cgraph" alt=""/></div>
<map name="classL4virtio_1_1Svr_1_1Block__dev_a9a96e928470518780132b45397e8ad35_cgraph" id="classL4virtio_1_1Svr_1_1Block__dev_a9a96e928470518780132b45397e8ad35_cgraph">
<area shape="rect" id="node2" href="namespaceL4.html#ab7194c6fc9267a3bf67a3888681ef3c5" title="static_cast for capabilities. " alt="" coords="217,5,319,32"/>
<area shape="rect" id="node4" href="namespaceL4Re.html#a64b057254a760643ba67a9ed452fede8" title="Check for valid capability or raise C++ exception. " alt="" coords="215,56,321,83"/>
<area shape="rect" id="node5" href="namespaceL4Re.html#a3f17984019f06676a7e3eecb41bbb0bb" title="Generate C++ exception on error. " alt="" coords="215,107,321,133"/>
<area shape="rect" id="node6" href="classL4virtio_1_1Virtqueue.html#a031d371276beec1cb5cf550be6fac491" title="Completely disable the queue. " alt="" coords="201,158,335,199"/>
<area shape="rect" id="node7" href="classL4virtio_1_1Svr_1_1Virtqueue.html#aa7e9493f7fe5bfa9ebaa5d80be8179cf" title="Get the next available descriptor from the available ring. " alt="" coords="188,223,348,265"/>
<area shape="rect" id="node8" href="classL4virtio_1_1Virtqueue.html#aa242e930433e8705c4ee00afaf58f686" title="Test if this queue is in working state. " alt="" coords="201,289,335,330"/>
<area shape="rect" id="node9" href="classL4_1_1Registry__iface.html#ab2b05d116e522ebe06ebabe32bd7283a" title="Register o as server&#45;side object for asynchronous IRQs. " alt="" coords="201,354,335,395"/>
<area shape="rect" id="node10" href="classL4_1_1Registry__iface.html#a5467da542075321062daab1bda1768bb" title="Register an L4::Epiface for an IPC gate available in the applications environment under the name serv..." alt="" coords="201,419,335,461"/>
<area shape="rect" id="node3" href="classL4_1_1Cap__base.html#a6181bad79c41cdbf5c030877b94e25bf" title="Return capability selector. " alt="" coords="396,5,533,32"/>
</map>
</div>

</div>
</div>
<a id="a684fb0f113476b80e6d393c807ff18f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a684fb0f113476b80e6d393c807ff18f5">&#9670;&nbsp;</a></span>reset_client()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Ds_data&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool <a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html">L4virtio::Svr::Block_dev</a>&lt; Ds_data &gt;::reset_client </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The client requests reinitialisation of the connection. </p>
<dl class="section return"><dt>Returns</dt><dd>False if reinitialisation is not supported. </dd>
<dd>
True if reinitialisation is supported and the client has been reinitialised successfully. </dd></dl>

<p class="definition">Definition at line <a class="el" href="virtio-block_source.html#l00505">505</a> of file <a class="el" href="virtio-block_source.html">virtio-block</a>.</p>

</div>
</div>
<a id="abeef159327c9e9b9ba2df195cc532c8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abeef159327c9e9b9ba2df195cc532c8f">&#9670;&nbsp;</a></span>set_blk_size()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Ds_data&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html">L4virtio::Svr::Block_dev</a>&lt; Ds_data &gt;::set_blk_size </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__l4__basic__types.html#gac1d09f3e382e711b776931f10e6e1e5a">l4_uint32_t</a>&#160;</td>
          <td class="paramname"><em>sz</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets block disk size to be reported to the client. </p>
<p>Setting this does not change the logical sector size used for addressing the device. </p>

<p class="definition">Definition at line <a class="el" href="virtio-block_source.html#l00348">348</a> of file <a class="el" href="virtio-block_source.html">virtio-block</a>.</p>

</div>
</div>
<a id="a350f618127159859e8f361b2d76dacbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a350f618127159859e8f361b2d76dacbc">&#9670;&nbsp;</a></span>set_config_wce()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Ds_data&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html">L4virtio::Svr::Block_dev</a>&lt; Ds_data &gt;::set_config_wce </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__l4__basic__types.html#ga9678dc2e6bf3e4d8ec950162576b0fad">l4_uint8_t</a>&#160;</td>
          <td class="paramname"><em>writeback</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets cache mode and enables the the writeback toggle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">writeback</td><td>Mode of the cache (0 for writethrough, 1 for writeback). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="virtio-block_source.html#l00391">391</a> of file <a class="el" href="virtio-block_source.html">virtio-block</a>.</p>

</div>
</div>
<a id="a85cb8c12aeca3b4538a1bb6c617b2a8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85cb8c12aeca3b4538a1bb6c617b2a8b">&#9670;&nbsp;</a></span>set_discard()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Ds_data&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html">L4virtio::Svr::Block_dev</a>&lt; Ds_data &gt;::set_discard </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__l4__basic__types.html#gac1d09f3e382e711b776931f10e6e1e5a">l4_uint32_t</a>&#160;</td>
          <td class="paramname"><em>max_discard_sectors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__l4__basic__types.html#gac1d09f3e382e711b776931f10e6e1e5a">l4_uint32_t</a>&#160;</td>
          <td class="paramname"><em>max_discard_seg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__l4__basic__types.html#gac1d09f3e382e711b776931f10e6e1e5a">l4_uint32_t</a>&#160;</td>
          <td class="paramname"><em>discard_sector_alignment</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets constraints for and enables the discard command. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">max_discard_sectors</td><td>Maximum discard sectors size. </td></tr>
    <tr><td class="paramname">max_discard_seg</td><td>Maximum discard segment number. </td></tr>
    <tr><td class="paramname">discard_sector_alignment</td><td>Can be used by the driver when splitting a request based on alignment. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="virtio-block_source.html#l00418">418</a> of file <a class="el" href="virtio-block_source.html">virtio-block</a>.</p>

</div>
</div>
<a id="a52e16868ed3be9c9dd2f1e1012f7a74e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52e16868ed3be9c9dd2f1e1012f7a74e">&#9670;&nbsp;</a></span>set_flush()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Ds_data&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html">L4virtio::Svr::Block_dev</a>&lt; Ds_data &gt;::set_flush </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enables the flush command. </p>

<p class="definition">Definition at line <a class="el" href="virtio-block_source.html#l00380">380</a> of file <a class="el" href="virtio-block_source.html">virtio-block</a>.</p>

</div>
</div>
<a id="abc38063578852cdd9b3c7ef343e370e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc38063578852cdd9b3c7ef343e370e9">&#9670;&nbsp;</a></span>set_size_max()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Ds_data&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html">L4virtio::Svr::Block_dev</a>&lt; Ds_data &gt;::set_size_max </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__l4__basic__types.html#gac1d09f3e382e711b776931f10e6e1e5a">l4_uint32_t</a>&#160;</td>
          <td class="paramname"><em>sz</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the maximum size of any single segment reported to client. </p>
<p>The limit is also applied to any incomming requests. Requests with larger segments result in an IO error being reported to the client. That means that <a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html#a8a23e93049f4a3d3bdc90103b4c5ea0e" title="Implements the actual processing of data in the device. ">process_request()</a> can safely make the assumption that all segments in the received request are smaller. </p>

<p class="definition">Definition at line <a class="el" href="virtio-block_source.html#l00306">306</a> of file <a class="el" href="virtio-block_source.html">virtio-block</a>.</p>

</div>
</div>
<a id="a9ab6d54f2230cb5b5d65489e78c7bee7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ab6d54f2230cb5b5d65489e78c7bee7">&#9670;&nbsp;</a></span>set_topology()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Ds_data&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html">L4virtio::Svr::Block_dev</a>&lt; Ds_data &gt;::set_topology </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__l4__basic__types.html#ga9678dc2e6bf3e4d8ec950162576b0fad">l4_uint8_t</a>&#160;</td>
          <td class="paramname"><em>physical_block_exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__l4__basic__types.html#ga9678dc2e6bf3e4d8ec950162576b0fad">l4_uint8_t</a>&#160;</td>
          <td class="paramname"><em>alignment_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__l4__basic__types.html#gac1d09f3e382e711b776931f10e6e1e5a">l4_uint32_t</a>&#160;</td>
          <td class="paramname"><em>min_io_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__l4__basic__types.html#gac1d09f3e382e711b776931f10e6e1e5a">l4_uint32_t</a>&#160;</td>
          <td class="paramname"><em>opt_io_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the I/O alignment information reported back to the client. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">physical_block_exp</td><td>Number of logical blocks per physical block(log2) </td></tr>
    <tr><td class="paramname">alignment_offset</td><td>Offset of the first aligned logical block </td></tr>
    <tr><td class="paramname">min_io_size</td><td>Suggested minimum I/O size in blocks </td></tr>
    <tr><td class="paramname">opt_io_size</td><td>Optimal I/O size in blocks </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="virtio-block_source.html#l00364">364</a> of file <a class="el" href="virtio-block_source.html">virtio-block</a>.</p>

</div>
</div>
<a id="a3761d8e4378958f269298ae4d3fc0cbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3761d8e4378958f269298ae4d3fc0cbb">&#9670;&nbsp;</a></span>set_write_zeroes()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Ds_data&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html">L4virtio::Svr::Block_dev</a>&lt; Ds_data &gt;::set_write_zeroes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__l4__basic__types.html#gac1d09f3e382e711b776931f10e6e1e5a">l4_uint32_t</a>&#160;</td>
          <td class="paramname"><em>max_write_zeroes_sectors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__l4__basic__types.html#gac1d09f3e382e711b776931f10e6e1e5a">l4_uint32_t</a>&#160;</td>
          <td class="paramname"><em>max_write_zeroes_seg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__l4__basic__types.html#ga9678dc2e6bf3e4d8ec950162576b0fad">l4_uint8_t</a>&#160;</td>
          <td class="paramname"><em>write_zeroes_may_unmap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets constraints for and enables the write zeroes command. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">max_write_zeroes_sectors</td><td>Maximum write zeroes sectors size. </td></tr>
    <tr><td class="paramname">max_write_zeroes_seg</td><td>maximum write zeroes segment number. </td></tr>
    <tr><td class="paramname">write_zeroes_may_unmap</td><td>Set if a write zeroes request can result in deallocating one or more sectors. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="virtio-block_source.html#l00438">438</a> of file <a class="el" href="virtio-block_source.html">virtio-block</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>l4/l4virtio/server/<a class="el" href="virtio-block_source.html">virtio-block</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceL4virtio.html">L4virtio</a></li><li class="navelem"><b>Svr</b></li><li class="navelem"><a class="el" href="classL4virtio_1_1Svr_1_1Block__dev.html">Block_dev</a></li>
    <li class="footer">Generated on Sun Nov 25 2018 13:45:56 for L4Re - L4 Runtime Environment by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
